# Flutter <-> React Bridge API (JSON-RPC)

## Оглавление

### authentication

- [authentication.logout](#authenticationlogout)

### broadcast

- [broadcast.goBack](#broadcastgoback)
- [broadcast.onLifecycleChanged](#broadcastonlifecyclechanged)

### clipboard

- [clipboard.copy](#clipboardcopy)
- [clipboard.paste](#clipboardpaste)

### Navigation

- [navigation.download](#navigationdownload)
- [navigation.downloadAndOpen](#navigationdownloadandopen)
- [navigation.openExternalLink](#navigationopenexternallink)
- [navigation.openWebModule](#navigationopenwebmodule)
- [navigation.pop](#navigationpop)
- [navigation.popUntil](#navigationpopuntil)
- [navigation.push](#navigationpush)
- [navigation.pushWithResult](#navigationpushwithresult)
- [navigation.replace](#navigationreplace)

### services

- [services.biometrics.authorize](#servicesbiometricsauthorize)
- [services.biometrics.getAvailableAuthType](#servicesbiometricsgetavailableauthtype)

---

## Описание методов

## authentication

### authentication.logout

Разлогиниться и перейти на экран логина.

**Ответы:**

- **`Response`** - Успешный переход и возврат результата

_Схема: `AuthenticationLogoutResponse`_

```json
{
  "success": "boolean - required"
}
```

| Поле      | Тип       | Описание                   | Обязательное |
| --------- | --------- | -------------------------- | ------------ |
| `success` | `boolean` | Результат операции выхода. | **Да**       |

---

## broadcast

### broadcast.goBack

С помощью этого метода можно повесить обработчик на системное действие назад в телефоне.

---

### broadcast.onLifecycleChanged

Переход на заданную страницу с ожиданием результата, имена страниц отличаются для флаттера и кордовы.

**Ответы:**

- **`Response`** - Успешный переход и возврат результата

_Схема: `BroadcastOnLifecycleChangedResponse`_

```json
{
  "lifecycleEvent": "string - required"
}
```

| Поле             | Тип      | Описание                      | Обязательное |
| ---------------- | -------- | ----------------------------- | ------------ |
| `lifecycleEvent` | `string` | _См. подробное описание ниже_ | **Да**       |

**Подробные описания полей:**

> **Поле: `lifecycleEvent`** (string)
>
> Текущее состояние жизненного цикла приложения.

| Значение   | Состояние  | Описание                                                                                                                                                    |
| ---------- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `resumed`  | Активно    | Приложение на экране и реагирует на ввод пользователя. Полноценная работа, интерфейс обновляется.                                                           |
| `inactive` | Не активно | Временное отсутствие фокуса: звонок, TouchID, переход в меню активных приложений и т.п. Не получает ввод, но остаётся на экране. Возможен переход в paused. |
| `paused`   | В фоне     | Приложение свернуто или не видно пользователю. Не получает ввод, не отрисовывает фреймы, выполняется в фоне.                                                |
| `detached` | Отключено  | Движок работает без отображения (например, FlutterView уничтожен). Код ещё выполняется, но view отсутствует. Возможен полный выход.                         |

---

---

## clipboard

### clipboard.copy

Сохраняет текст в буфер обмена.

**Тело запроса:**

_Схема: `ClipboardCopyRequest`_

```json
{
  "text": "string - required"
}
```

| Поле   | Тип      | Описание                        | Обязательное |
| ------ | -------- | ------------------------------- | ------------ |
| `text` | `string` | Текст, который нужно сохранить. | **Да**       |

**Ответы:**

- **`Response`** - Успешный переход и возврат результата

_Схема: `ClipboardCopyResponse`_

```json
{
  "text": "string - required"
}
```

| Поле   | Тип      | Описание                   | Обязательное |
| ------ | -------- | -------------------------- | ------------ |
| `text` | `string` | Текст, который копировали. | **Да**       |

---

### clipboard.paste

Возвращает последнее сохраненное в буфер обмена.

**Ответы:**

- **`Response`** - Успешный переход и возврат результата

_Схема: `ClipboardPasteResponse`_

```json
{
  "text": "string - required"
}
```

| Поле   | Тип      | Описание                | Обязательное |
| ------ | -------- | ----------------------- | ------------ |
| `text` | `string` | Текст из буфера обмена. | **Да**       |

---

## Navigation

### navigation.download

Скачивает файл по переданной ссылке.

**Тело запроса:**

_Схема: `NavigationDownloadAndOpenRequest`_

```json
{
  "url": "string - required",
  "queryArgs": "object"
}
```

| Поле        | Тип      | Описание                             | Обязательное |
| ----------- | -------- | ------------------------------------ | ------------ |
| `url`       | `string` | Ссылка на файл для скачивания.       | **Да**       |
| `queryArgs` | `object` | Дополнительные параметры скачивания. | Нет          |

**Ответы:**

- **`Response`** - Успешный переход и возврат результата

_Схема: `NavigationDownloadAndOpenResponse`_

```json
{
  "path": "string - required"
}
```

| Поле   | Тип      | Описание                           | Обязательное |
| ------ | -------- | ---------------------------------- | ------------ |
| `path` | `string` | Локальный путь к скачанному файлу. | **Да**       |

---

### navigation.downloadAndOpen

Скачивает файл по переданной ссылке и открывает его. После скачивание попытается открыть файл в стороннем приложении, если соответствующее установлено (например сторонний Pdf viewer)

**Тело запроса:**

_Схема: `NavigationDownloadAndOpenRequest`_

```json
{
  "url": "string - required",
  "queryArgs": "object"
}
```

| Поле        | Тип      | Описание                             | Обязательное |
| ----------- | -------- | ------------------------------------ | ------------ |
| `url`       | `string` | Ссылка на файл для скачивания.       | **Да**       |
| `queryArgs` | `object` | Дополнительные параметры скачивания. | Нет          |

**Ответы:**

- **`Response`** - Успешный переход и возврат результата

_Схема: `NavigationDownloadAndOpenResponse`_

```json
{
  "path": "string - required"
}
```

| Поле   | Тип      | Описание                           | Обязательное |
| ------ | -------- | ---------------------------------- | ------------ |
| `path` | `string` | Локальный путь к скачанному файлу. | **Да**       |

---

### navigation.openExternalLink

Открывает сайт в браузере внутри хоста.

**Тело запроса:**

_Схема: `NavigationOpenExternalLinkRequest`_

```json
{
  "url": "string - required",
  "needOpenExternalBrowser": "boolean"
}
```

| Поле                      | Тип       | Описание                                                                                                                         | Обязательное |
| ------------------------- | --------- | -------------------------------------------------------------------------------------------------------------------------------- | ------------ |
| `url`                     | `string`  | Адрес сайта.                                                                                                                     | **Да**       |
| `needOpenExternalBrowser` | `boolean` | При значении true - браузер запустится в отдельном приложении, в другом случае открывает окно браузера внутри нашего приложения. | Нет          |

---

### navigation.openWebModule

Открытие другого веб модуля. Самое главное - передать правильный path (хвостик урла веб модуля) и параметры, если они нужны для корректной работы веб модуля.

**Тело запроса:**

_Схема: `NavigationOpenWebModuleRequest`_

```json
{
  "path": "string - required",
  "queryArgs": "object",
  "replace": "boolean"
}
```

| Поле        | Тип       | Описание                                                                               | Обязательное |
| ----------- | --------- | -------------------------------------------------------------------------------------- | ------------ |
| `path`      | `string`  | Хвостик, все что после стэнда, от полного урла веб-модуля                              | **Да**       |
| `queryArgs` | `object`  | Мапа, ключ значение. Параметры, которые будут переданы в веб-модуль через метод init.  | Нет          |
| `replace`   | `boolean` | Необходимо ли заменить (закрыть) текущий веб-модуль в стеке навигации хост-приложения. | Нет          |

**Ответы:**

- **`Response`** - Команда на открытие модуля успешно отправлена

_Схема: `NavigationOpenWebModuleResponse`_

```json
{
  "type": "unknown"
}
```

---

### navigation.pop

Метод для закрытия страницы с web-приложением.

**Тело запроса:**

_Схема: `NavigationPopRequest`_

```json
{
  "value": "any"
}
```

| Поле    | Тип   | Описание                                                       | Обязательное |
| ------- | ----- | -------------------------------------------------------------- | ------------ |
| `value` | `any` | Значение для возврата на предыдущую страницу. Данные для хоста | Нет          |

---

### navigation.popUntil

Метод для возврата до заданной страницы в стеке навигации. Т.е. при вызове данного метода будут закрываться все страницы, пока не встретится страница с заданным путем.

**Тело запроса:**

_Схема: `NavigationPopUntilRequest`_

```json
{
  "path": "string - required"
}
```

| Поле   | Тип      | Описание                                                                             | Обязательное |
| ------ | -------- | ------------------------------------------------------------------------------------ | ------------ |
| `path` | `string` | Путь страницы, перед которой необходимо закрыть все страницы выше в стеке навигации. | **Да**       |

---

### navigation.push

Переход на заданную страницу страницу, имена страниц отличаются для флаттера и кордовы.

**Тело запроса:**

_Схема: `NavigationPushRequest`_

```json
{
  "path": "string - required",
  "queryArgs": "object"
}
```

| Поле        | Тип      | Описание                                | Обязательное |
| ----------- | -------- | --------------------------------------- | ------------ |
| `path`      | `string` | Путь до страницы, которую надо открыть. | **Да**       |
| `queryArgs` | `object` | Аргументы для передачи на страницу.     | Нет          |

---

### navigation.pushWithResult

Переход на заданную страницу с ожиданием результата, имена страниц отличаются для флаттера и кордовы.

**Тело запроса:**

_Схема: `NavigationPushRequest`_

```json
{
  "path": "string - required",
  "queryArgs": "object"
}
```

| Поле        | Тип      | Описание                                | Обязательное |
| ----------- | -------- | --------------------------------------- | ------------ |
| `path`      | `string` | Путь до страницы, которую надо открыть. | **Да**       |
| `queryArgs` | `object` | Аргументы для передачи на страницу.     | Нет          |

**Ответы:**

- **`Response`** - Успешный переход и возврат результата

_Схема: `NavigationPushWithResultResponse`_

```json
{
  "type": "unknown"
}
```

---

### navigation.replace

Замена текущей страницы с WebView на страницу по заданному пути.

**Тело запроса:**

_Схема: `NavigationPushRequest`_

```json
{
  "path": "string - required",
  "queryArgs": "object"
}
```

| Поле        | Тип      | Описание                                | Обязательное |
| ----------- | -------- | --------------------------------------- | ------------ |
| `path`      | `string` | Путь до страницы, которую надо открыть. | **Да**       |
| `queryArgs` | `object` | Аргументы для передачи на страницу.     | Нет          |

---

## services

### services.biometrics.authorize

Авторизация по биометрии.

**Ответы:**

- **`Response`** - Успешный переход и возврат результата

_Схема: `ServicesBiometrics.authorizeResponse`_

```json
{
  "type": "boolean"
}
```

---

### services.biometrics.getAvailableAuthType

Получение доступного типа биометрии на устройстве.

**Ответы:**

- **`Response`** - Успешный возврат типа биометрии

_Схема: `ServicesBiometrics.getAvailableAuthTypeResponse`_

```json
{
  "type": "string"
}
```

---
